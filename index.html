<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Sarshti ‚ú®</title>
    <style>
        body, html {
            margin: 0; padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #fff0f3;
            font-family: 'Georgia', serif;
            overflow: hidden;
            text-align: center;
            transition: background 1s ease, background-image 1s ease;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        /* Overlay to make text readable over the dark rose background */
        .bg-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); /* Slightly darker for better contrast */
            display: none;
            z-index: 1;
        }

        #container {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px); /* Increased blur for glass effect */
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(255, 77, 109, 0.3);
            max-width: 500px;
            width: 85%;
            z-index: 10;
            position: relative;
            transition: all 0.5s ease;
        }

        .step { display: none; animation: fadeIn 1s ease-in-out; }
        .active { display: block; }

        h2 { color: #ff4d6d; font-size: 1.8em; margin-bottom: 20px; }
        p { color: #333; line-height: 1.8; font-size: 1.1em; font-weight: 500; }

        .btn-next {
            background: #ff4d6d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 20px;
            font-size: 1em;
            transition: transform 0.2s;
        }
        .btn-next:hover { transform: scale(1.05); }

        /* Timeline Styles */
        .timeline {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding: 20px 0;
            scrollbar-width: none;
        }
        .timeline-item {
            min-width: 200px;
            height: 250px;
            background: #eee;
            border-radius: 15px;
            overflow: hidden;
            flex-shrink: 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .timeline-item img { width: 100%; height: 100%; object-fit: cover; }

        .game-container { position: relative; height: 150px; margin-top: 20px; }
        #yesBtn { background: #ff4d6d; color: white; border: none; padding: 15px 35px; border-radius: 50px; font-weight: bold; cursor: pointer; font-size: 1.2em; }
        #noBtn { background: #adb5bd; color: white; border: none; padding: 10px 20px; border-radius: 50px; position: absolute; cursor: pointer; white-space: nowrap; }

        .bouquet { font-size: 100px; margin-bottom: 10px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .floating-item { position: absolute; opacity: 0.3; z-index: 1; animation: float 8s infinite linear; }
        @keyframes float { 0% { transform: translateY(0) rotate(0); } 100% { transform: translateY(-100vh) rotate(360deg); } }

        #canvas { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 15; }
    </style>
</head>
<body>

    <audio id="bgMusic" loop><source src="ks.mp3" type="audio/mpeg"></audio>
    <audio id="successMusic"><source src="if.mp3" type="audio/mpeg"></audio>
    <audio id="finalMusic" loop><source src="final.mp3" type="audio/mpeg"></audio>

    <div id="overlay" class="bg-overlay"></div>
    <canvas id="canvas"></canvas>

    <div class="floating-item" style="left: 5%; bottom: 0; font-size: 40px;">üå∏</div>
    <div class="floating-item" style="left: 25%; bottom: -10%; font-size: 30px; animation-delay: 2s;">üìñ</div>
    <div class="floating-item" style="right: 15%; bottom: -20%; font-size: 50px; animation-delay: 4s;">üíù</div>
    <div class="floating-item" style="right: 5%; bottom: 0; font-size: 35px; animation-delay: 1s;">‚ú®</div>

    <div id="container">
        <div id="step1" class="step active">
            <h2>Hey Sarshti... ‚ú®</h2>
            <p>I‚Äôve built something special to tell you what's on my mind.<br>Before we start, make sure your volume is up! üéµ</p>
            <button class="btn-next" onclick="startExperience()">Open My Message</button>
        </div>

        <div id="step2" class="step">
            <h2 style="color: #ff4d6d;">The Impression...</h2>
            <p>I‚Äôve been thinking about that day at the wedding. We haven't met face-to-face yet, but talking to you feels like finding a favorite book I never knew I had.</p>
            <button class="btn-next" onclick="nextStep(3)">Click to continue...</button>
        </div>

        <div id="step3" class="step">
            <h2 style="color: #ff4d6d;">Our Little World</h2>
            <p>Even though there's a 4-year gap and we come from different worlds‚ÄîCommerce and B.Tech‚Äîour calls and chats have a 'balance' that no ledger could explain.</p>
            <button class="btn-next" onclick="nextStep(4)">See our journey...</button>
        </div>

        <div id="step4" class="step">
            <h2>Moments We Shared</h2>
            <p>Our chats, our calls, and these memories...</p>
            <div class="timeline">
                <div class="timeline-item"><img src="photo1.jpg" alt="Memory 1"></div>
                <div class="timeline-item"><img src="photo2.jpg" alt="Memory 2"></div>
                <div class="timeline-item"><img src="photo3.jpg" alt="Memory 3"></div>
            </div>
            <button class="btn-next" onclick="nextStep(5)">One more thing...</button>
        </div>

        <div id="step5" class="step">
            <h2>The Big Question</h2>
            <p>I want to upgrade our "connection" to the next version. Would you give this 1st-year student the honor of being your Valentine?</p>
            <div class="game-container">
                <button id="yesBtn" onclick="celebrate()">YES! ‚ù§Ô∏è</button>
                <button id="noBtn" onmouseover="moveNo()">No</button>
            </div>
        </div>

        <div id="step6" class="step">
            <div class="bouquet">üíê</div>
            <h2>I knew it! ‚ù§Ô∏è</h2>
            <p>The deal is finalized, Sarshti! üòâ</p>
            <p><b>When and where are we finally meeting for our date?</b></p>
            <button class="btn-next" onclick="showSurprise()">Click for one last surprise...</button>
        </div>
    </div>

    <script>
        let noCount = 0;
        const bgMusic = document.getElementById('bgMusic');
        const successMusic = document.getElementById('successMusic');
        const finalMusic = document.getElementById('finalMusic');
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        // Use the rose background you provided
        const ROSE_BG = "https://images.rawpixel.com/image_800/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA1L3AtNDYyLWV5ZS0wMzU0LmpwZw.jpg";

        function startExperience() {
            bgMusic.play().catch(e => console.log("Music play blocked by browser until interaction"));
            nextStep(2);
        }

        function nextStep(stepNum) {
            const body = document.body;
            const overlay = document.getElementById('overlay');
            const container = document.getElementById('container');

            // Handle Background Changes using the Rose Image
            if(stepNum >= 2 && stepNum <= 4) {
                body.style.backgroundImage = `url('${ROSE_BG}')`;
                overlay.style.display = "block";
                container.style.background = "rgba(255, 255, 255, 0.85)";
            } else if(stepNum === 5) {
                body.style.backgroundImage = `url('${ROSE_BG}')`;
                overlay.style.display = "block";
                container.style.background = "rgba(255, 255, 255, 1)";
            } else {
                body.style.backgroundImage = "none";
                overlay.style.display = "none";
                container.style.background = "rgba(255, 255, 255, 1)";
            }

            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById('step' + stepNum).classList.add('active');
        }

        function celebrate() {
            bgMusic.pause();
            successMusic.play();
            nextStep(6);
            launchHearts();
        }

        function showSurprise() {
            successMusic.pause();
            finalMusic.play().catch(e => console.log(e));
            document.getElementById('container').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('container').style.display = 'none';
                canvas.style.display = 'block';
                initParticles();
                animateParticles();
            }, 1000);
        }

        function moveNo() {
            const noBtn = document.getElementById('noBtn');
            const x = Math.random() * (window.innerWidth - 150);
            const y = Math.random() * (window.innerHeight - 50);
            noBtn.style.position = 'fixed';
            noBtn.style.left = x + 'px'; noBtn.style.top = y + 'px';
            const messages = ["Think Again!!", "Don't test my Patience! üò§", "Yes is best ROI !!"];
            noBtn.innerText = messages[noCount % messages.length];
            noCount++;
        }

        // --- PARTICLE ENGINE ---
        let particles = [];
        const PARTICLE_COUNT = 8000;
        const HEART_SCALE = 18;
        let exploded = false;

        window.addEventListener('mousedown', () => {
            exploded = true;
            setTimeout(() => { exploded = false; }, 2500);
        });

        class Particle {
            constructor(targetX, targetY, isText = false) {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.baseX = targetX;
                this.baseY = targetY;
                this.vx = (Math.random() - 0.5) * 25;
                this.vy = (Math.random() - 0.5) * 25;
                this.acc = isText ? 0.15 : 0.08;
                this.friction = 0.92;
                this.size = isText ? Math.random() * 2 + 1.2 : Math.random() * 1 + 0.5;
                this.color = isText ? "#ffffff" : "#ff1a4d";
                this.isText = isText;
            }
            update() {
                if (exploded) {
                    this.x += this.vx; this.y += this.vy;
                    this.vx *= this.friction; this.vy *= this.friction;
                } else {
                    let dx = this.baseX - this.x;
                    let dy = this.baseY - this.y;
                    this.x += dx * this.acc; this.y += dy * this.acc;
                    this.vx = (Math.random() - 0.5) * 30;
                    this.vy = (Math.random() - 0.5) * 30;
                }
                this.x += Math.sin(Date.now() * 0.002 + this.baseX) * 0.3;
                this.y += Math.cos(Date.now() * 0.002 + this.baseY) * 0.3;
            }
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                if(this.isText) { ctx.shadowBlur = 15; ctx.shadowColor = "#ff80bf"; }
                else { ctx.shadowBlur = 2; ctx.shadowColor = "#ff1a4d"; }
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        function initParticles() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            particles = [];
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            const textCanvas = document.createElement('canvas');
            const tCtx = textCanvas.getContext('2d');
            textCanvas.width = canvas.width; textCanvas.height = canvas.height;
            tCtx.fillStyle = 'white';
            tCtx.font = '900 65px Arial'; 
            tCtx.textAlign = 'center';
            tCtx.fillText("I love you, Sarshti", centerX, centerY + 20);
            
            const pixels = tCtx.getImageData(0, 0, canvas.width, canvas.height).data;
            const textTargets = [];
            for (let y = 0; y < canvas.height; y += 3) {
                for (let x = 0; x < canvas.width; x += 3) {
                    if (pixels[(y * canvas.width + x) * 4] > 128) textTargets.push({x, y});
                }
            }

            for (let i = 0; i < PARTICLE_COUNT; i++) {
                if (i < textTargets.length) {
                    particles.push(new Particle(textTargets[i].x, textTargets[i].y, true));
                } else {
                    const t = Math.random() * Math.PI * 2;
                    const r = 0.3 + Math.random() * 0.7; 
                    const x = 16 * Math.pow(Math.sin(t), 3);
                    const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
                    particles.push(new Particle(centerX + x * HEART_SCALE * r, centerY - y * HEART_SCALE * r, false));
                }
            }
        }

        function animateParticles() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.25)"; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animateParticles);
        }

        function launchHearts() {
            for(let i=0; i<30; i++) {
                const heart = document.createElement('div');
                heart.innerHTML = '‚ù§Ô∏è'; heart.style.position = 'fixed';
                heart.style.left = Math.random() * 100 + 'vw'; heart.style.top = '100vh';
                heart.style.fontSize = '25px'; heart.style.zIndex = '100';
                heart.style.transition = 'transform 4s linear, opacity 4s';
                document.body.appendChild(heart);
                setTimeout(() => {
                    heart.style.transform = `translateY(-120vh) translateX(${Math.random() * 200 - 100}px)`;
                    heart.style.opacity = '0';
                }, 100);
                setTimeout(() => heart.remove(), 4000);
            }
        }
    </script>
</body>
</html>
